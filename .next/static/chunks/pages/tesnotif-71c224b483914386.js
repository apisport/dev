(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6],{6879:function(t,n,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tesnotif",function(){return e(1025)}])},1025:function(t,n,e){"use strict";e.r(n),e.d(n,{default:function(){return g}});var o=e(4051),i=e.n(o),r=e(5893),s=e(7294);function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function a(t,n,e,o,i,r,s){try{var c=t[r](s),a=c.value}catch(u){return void e(u)}c.done?n(a):Promise.resolve(a).then(o,i)}function u(t){return function(){var n=this,e=arguments;return new Promise((function(o,i){var r=t.apply(n,e);function s(t){a(r,o,i,s,c,"next",t)}function c(t){a(r,o,i,s,c,"throw",t)}s(void 0)}))}}function f(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function l(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}function h(t,n){return!n||"object"!==d(n)&&"function"!==typeof n?c(t):n}function b(t,n){return b=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t},b(t,n)}var d=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function v(t){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,o=p(t);if(n){var i=p(this).constructor;e=Reflect.construct(o,arguments,i)}else e=o.apply(this,arguments);return h(this,e)}}var g=function(t){!function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&b(t,n)}(p,t);var n,e,o,a=v(p);function p(t){var n;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,p),l(c(n=a.call(this,t)),"updateUserConsent",(function(t){console.log(t),"granted"===t?console.log("Diperbolehkan"):console.log("Tidak Diperbolehkan")})),l(c(n),"initializePushNotifications",(function(){return Notification.requestPermission((function(t){return t}))})),l(c(n),"AskPermission",(function(){n.initializePushNotifications().then(n.updateUserConsent)})),l(c(n),"createNotificationSubscription",(function(){return navigator.serviceWorker.ready.then((function(t){return t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:"BL3Sv8nFM_tvnILPoGNG6rlLPqubF_mEOpDkaaeyNM2KU3BLih-PLJAtdgfGPPnwZFTDB_KCZJp1hiYSUx9wfxs"}).then((function(t){return console.log("User is subscribed.",t),t}))}))})),l(c(n),"CreateSubscription",(function(){n.createNotificationSubscription().then((function(t){n.showUserSubscription(t)}))})),l(c(n),"showUserSubscription",(function(t){n.setState({userSubscrition:t,userSubscritionText:JSON.stringify(t,null," ")})}));var e=c(n);l(c(n),"SendSubscriptionToPushServer",u(i().mark((function t(){var n;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/api/notifikasiMitra",{credentials:"omit",method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},mode:"cors",body:JSON.stringify(e.state.userSubscrition)});case 2:(n=t.sent).status>=200&&n.status<300?n.json().then((function(t){e.state.subscritionId=t.id,console.log("sukses push to server: "+t.id)})).catch((function(t){console.log("gagal")})):console.log("gagal Error");case 4:case"end":return t.stop()}}),t)}))));var o=c(n);return l(c(n),"SendNotification",u(i().mark((function t(){var n;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/api/notifikasiMitra/"+o.state.subscritionId,{credentials:"omit",method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},mode:"cors"});case 2:(n=t.sent).status>=200&&n.status<300?n.json().then((function(t){console.log("suksek send notification : "+t)})).catch((function(t){console.log("gagal")})):console.log("gagal Error");case 4:case"end":return t.stop()}}),t)})))),l(c(n),"SendNotificationLocal",u(i().mark((function t(){var n;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:"http://localhost:3000/ico.png","Pembayaran Anda dengan No. Invoice #128988 Telah diterima!","Pembayaran Diterima",n={body:"Pembayaran Anda dengan No. Invoice #128988 Telah diterima!",icon:"logo_stikom.ico",vibrate:[200,100,200],tag:"new-product",image:"http://localhost:3000/ico.png",actions:[{action:"Detail",title:"View",icon:"logo_stikom.ico"}]},navigator.serviceWorker.ready.then((function(t){t.showNotification("Pembayaran Diterima",n)}));case 5:case"end":return t.stop()}}),t)})))),l(c(n),"isPushNotificationSupported",(function(){return"serviceWorker"in navigator&&"PushManager"in window})),l(c(n),"getUserSubscription",(function(){return navigator.serviceWorker.ready.then((function(t){return t.pushManager.getSubscription()})).then((function(t){return t}))})),l(c(n),"RegisterService",(function(){"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("/service-worker.js").then((function(t){console.log("Service Worker registration successful with scope: ",t.scope)}),(function(t){console.log("Service Worker registration failed: ",t)}))}))})),n.videBackground=(0,s.createRef)(),n.state={tinggi:0,userSubscrition:null,userSubscritionText:"",subscritionId:null},n}return n=p,(e=[{key:"componentDidMount",value:function(){if(this.isPushNotificationSupported()){var t=this;this.updateUserConsent(Notification.permission),this.getUserSubscription().then((function(n){n&&t.showUserSubscription(n)}))}}},{key:"render",value:function(){return(0,r.jsx)("div",{className:"row",children:(0,r.jsxs)("div",{className:"col-lg-12 text-center",children:[(0,r.jsx)("button",{type:"button",className:"btn btn-primary",onClick:this.AskPermission,children:"Ask Permission"}),(0,r.jsx)("br",{}),(0,r.jsx)("button",{type:"button",className:"btn btn-primary",onClick:this.CreateSubscription,children:"Create Notification Subscription"}),(0,r.jsx)("br",{}),(0,r.jsx)("button",{type:"button",className:"btn btn-primary",onClick:this.SendSubscriptionToPushServer,children:"Send subscription to push server"}),(0,r.jsx)("br",{}),(0,r.jsx)("button",{type:"button",className:"btn btn-primary",onClick:this.SendNotification,children:"Send a push notification"}),(0,r.jsx)("br",{}),(0,r.jsx)("button",{type:"button",className:"btn btn-primary",onClick:this.SendNotificationLocal,children:"Send a push notification Local"}),(0,r.jsx)("br",{}),(0,r.jsx)("textarea",{className:"form-control",value:this.state.userSubscritionText,onChange:function(){}})]})})}}])&&f(n.prototype,e),o&&f(n,o),p}(s.Component)}},function(t){t.O(0,[774,888,179],(function(){return n=6879,t(t.s=n);var n}));var n=t.O();_N_E=n}]);